<div class="container-fluid">
    <savage-message2></savage-message2>
    <h4><button type="button" class="btn btn-primary" (click)="isCollapsed = !isCollapsed">{{isCollapsed ? '+' : '-'}}</button>  Events</h4>
    <form #equipmentTripEventForm="ngForm" (ngSubmit)="submitForm(equipmentTripEventForm)" form-inline >
        <div class="col-sm-12 row">
            <div class="col-sm-10" [collapse]="isCollapsed">
                <table class="table table-condensed table-bordered table-responsive table-striped table-hover">
                    <thead>
                        <tr>
                            <th>Event</th>
                            <th>Type</th>
                            <th>Set Date</th>
                            <th>Remove Date</th>
                            <th>L/E</th>
                            <th>Carrier Details</th>
                            <th>Carrier Location</th>
                            <th>From Location</th>
                            <th>To Location</th>
                            <th>Severity</th>
                            <th>Comment</th>
                            <th>Voided</th>
                        </tr>
                    </thead>

                    <tbody *ngIf="equipmentTripEvents"  >
                        <tr style="cursor: pointer" (click)="onEdit(i,$event)" *ngFor="let equipmentTripEvent of equipmentTripEventList;let i=index">
                            <td>{{equipmentTripEvent.event}}</td>
                            <td>{{equipmentTripEvent.eventType}}</td>
                            <td>{{equipmentTripEvent.setDate | date: 'MM/dd/yyyy'}}</td>
                            <td>{{equipmentTripEvent.removeDate  | date: 'MM/dd/yyyy'}}</td>
                            <td>{{equipmentTripEvent.loadedEmptyStatus}}</td>
                            <td>{{equipmentTripEvent.carrierDetails}}</td>
                            <td>{{equipmentTripEvent.carrierLocation}}</td>
                            <td>{{getLocationName(equipmentTripEvent.locationId)}}</td>
                            <td>{{getLocationName(equipmentTripEvent.toLocationId)}}</td>
                            <td>{{equipmentTripEvent.severity}}</td>
                            <td>{{equipmentTripEvent.comment}}</td>
                            <td><input type="checkbox" class="checkbox" name="{{i}}IsVoided" #{{i}}IsActive="ngModel"
                                    (click)="onEditDoNothing(i,$event)" (change)="onChangeIsVoided(i,$event)" [(ngModel)]=equipmentTripEvent.isVoided
                                    [disabled]="!pageSecurity.isWritable ? true : null"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-sm-2" [collapse]="isCollapsed">
                <button class="btn btn-primary" type="button" (click)="onAddEvent()" [disabled]="equipmentTrip && (equipmentTrip.equipmentTripId ==0  || equipmentTrip.equipmentTripId ==null) || !pageSecurity.isWritable">Add Event</button>
            </div>
        </div>
        <popup #equipmentTripEventPopup (confirmClick)="onSaveEquipmentTripEvent($event)" (cancelClick)="onCancelEquipmentTripEvent()">
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <savage-message2></savage-message2>
                <label for="event" class="col-sm-2 col-form-label">Event*</label>
                <div class="col-sm-4">
                    <select class="form-control readOnly" name="event" [(ngModel)]=equipmentTripEventObject.event  (change)="onChangeEquipmentripEvent($event.target.value)"
                    required> 
                        <option [ngValue]=null>Select</option>
                    <option *ngFor="let equipmentTripEvent of equipmentTripEvents" [value]="equipmentTripEvent" [disabled]="!pageSecurity.isWritable">{{equipmentTripEvent}}</option>
                </select>
                </div>
                <label for="eventType" class="col-sm-2 col-form-label">Event Type*</label>
                <div class="col-sm-4">
                    <select class="form-control readOnly" name="eventType" [(ngModel)]=equipmentTripEventObject.eventType required> 
                        <option [ngValue]=""></option>
                    <option *ngFor="let equipmentTripEventType of equipmentTripEventTypes" [value]="equipmentTripEventType" [disabled]="!pageSecurity.isWritable">{{equipmentTripEventType}}</option>
                </select>
                </div>
            </div>
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <label for="shipDate" class="col-sm-2 col-form-label">Set Date*</label>
                <div class="col-sm-4">
                    <!--<input type="date" class="form-control readOnly" name="setDate" [(ngModel)]=equipmentTripEventObject.setDate required useValueAsDate>-->
                    <input ngui-datetime-picker class="form-control readOnly" name="setDate" [(ngModel)]=equipmentTripEventObject.setDate required/>
                </div>
                <label for="shipDate" class="col-sm-2 col-form-label">Remove Date</label>
                <div class="col-sm-4">
                    <!--<input type="date" class="form-control readOnly" name="removeDate" [(ngModel)]=equipmentTripEventObject.removeDate useValueAsDate>-->
                    <input ngui-datetime-picker class="form-control readOnly" name="removeDate" [(ngModel)]=equipmentTripEventObject.removeDate   />
                </div>
            </div>
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <label for="loadedEmptyStatus" class="col-sm-2 col-form-label">Loaded Status*</label>
                <div class="col-sm-4">
                    <select class="form-control readOnly" name="loadedEmptyStatus" [(ngModel)]=equipmentTripEventObject.loadedEmptyStatus required> 
                        <option [ngValue]=""></option>
                        <option *ngFor="let equipmentTripLoadedStatus of equipmentTripLoadedStatuses" [value]="equipmentTripLoadedStatus" [disabled]="!pageSecurity.isWritable">{{equipmentTripLoadedStatus}}</option>
                </select>
                </div>
                <label for="severity" class="col-sm-2 col-form-label">Severity*</label>
                <div class="col-sm-4">
                    <select class="form-control readOnly" name="severity" [(ngModel)]=equipmentTripEventObject.severity required> 
                        <option [ngValue]=""></option>
                        <option *ngFor="let equipmentTripSeverity of equipmentTripSeverities" [value]="equipmentTripSeverity" [disabled]="!pageSecurity.isWritable">{{equipmentTripSeverity}}</option>
                </select>
                </div>
            </div>
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <label for="carrierDetails" class="col-sm-2 col-form-label">Carrier Details</label>
                <div class="col-sm-4">
                    <input type="text" class="form-control readOnly" name="carrierDetails" [(ngModel)]=equipmentTripEventObject.carrierDetails
                        >
                </div>
                <label for="carrierLocation" class="col-sm-2 col-form-label">Carrier Location</label>
                <div class="col-sm-4">
                    <input type="text" class="form-control readOnly" name="carrierLocation" [(ngModel)]=equipmentTripEventObject.carrierLocation>
                </div>
            </div>
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <label for="locationId" class="col-sm-2 col-form-label">Location</label>
                <div class="col-sm-4">
                   {{locationName}} 
                </div>                
                <label for="toLocationId" class="col-sm-2 col-form-label">To Location</label>
                <div class="col-sm-4">
                    <select class="form-control readOnly" id="toLocationId" name="toLocationId" [(ngModel)]=equipmentTripEventObject.toLocationId> 
                        <option ng-value=""></option>
                        <option *ngFor="let location of locationListForSelect" 
                    [value]="location.locationId" [disabled]="!pageSecurity.isWritable"
                    >{{location.locationName}}</option>
                </select>
                </div>

            </div>
            <div class="form-group row" *ngIf="equipmentTripEventObject">
                <label for="comment" class="col-sm-2 col-form-label">Comment</label>
                <div class="col-sm-4">
                    <input type="text" class="form-control readOnly" name="comment" [(ngModel)]=equipmentTripEventObject.comment>
                </div>
                <label for="isVoided" class="col-sm-2 col-form-label">Voided</label>
                <div class="col-sm-4">
                    <input type="checkbox" class="readOnly" name="isVoided" [(ngModel)]=equipmentTripEventObject.isVoided>
                </div>
            </div>
            <div style="margin-bottom:20px;margin-top:20px;float: right">
            <button type="button" class="btn btn-primary" [disabled]="false" (click)="onSaveEquipmentTripEvent($event)">Save</button>
            <button type="button" class="btn btn-primary" [disabled]="false" (click)="onCancelEquipmentTripEvent($event)">Cancel</button>
            </div>
        </popup>
    </form>
    <!--equipmentTripEventObject: {{equipmentTripEventObject | json}}-->
    <!--equipmentTrip: {{equipmentTrip | json}}-->